# Config file for automatic building at travis-ci.org

language: python
sudo: false

python:
  - "3.6"

matrix:
  fast_finish: true
  include:
    - python: "3.6.1"
      env: TOXENV=lint
    - python: "3.6.1"
      env: TOXENV=lint
    - python: "3.6.1"
      env: TOXENV=py36
    - python: "3.7"
      env: TOXENV=py37

cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/download

before_install:
  - wget http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH="$HOME/miniconda/bin:$PATH"
  - hash -r
  - conda config --set always_yes yes --set changeps1 no
  - conda config --add channels conda-forge
  - conda update -q conda
  - conda config --set auto_update_conda no

install:
  - conda create -q -n jmbuild python=$TRAVIS_PYTHON_VERSION
  - source activate jmbuild
  - conda install tox
  - conda install pexpect openpyxl
  - conda install pip
  - pip install .

script:
  - tox -e lint
  - tox -e pylint
  - tox -e py37
  - tox -e docs

after_success:
  - conda install -c conda-forge codecov
  - conda install conda-build anaconda-client pytest pytest-cov
  - codecov
  - coveralls
  - conda build conda.recipe --no-test
  - conda install --use-local jmopenorders
  - conda info -a

deploy:
  provider: pypi
  skip_upload_docs: true
  user: jmuelbert
  password:
    secure: "blWLOCNJ/UuEK2tg4dpgd2pkRvIXlvJmFSv7vF06k+BSacTtRVn5L+syXkcJDjB8eOm1FLBAwlcqt2W6/KACrV0NnfyNj8kuBaIUVrJhWJ+7osoMGJR2tH/TqIFxYFgRs0ZcolfhCVWX0ApRt127526vhUR5m+BLlCRfMlGT4fRgK3Wd7x4YNabjk+t2AHAzDu2v43r95ozxFQALTZHwRg06DrVxuE1eU6QRA6k1mx68DVDmKjjjDVCMCHeTuiqXJ8yPF4btO9mo88B6lMlUQ/grIbY9XTCncscgrZyvuiToERbOeTsQllvVSbl1E2HXcDRBIQR/+M/gy0583Fwf33+cIrITaEtKhe5XU8jykAnW05kcTN81TEKPCxuJYRfkzyZ6+1TDtixniI9/sofwED8cN85yql8xhO44GPPeMfSBLHNAzScd73KhSMz2xDXfWxF9oBjtt3KoEM/v7CVHc+wSuxR/hT/++w2tJgxxxsnX8ntC8zkA7JgAMZn2rgRefYXeR24EQmmWiWJBABlfijYM7SqBEYrEVrV8TOQpfJ09X2CbqNlTMOlqzZBSNHGrMRR4+UsRgAvoYlUXifwRCYr/qY3XJqW8baGRogRYL6ASSTXO/DTC/QVpWqWg57Ey6gejG+NRhCeJsJCm0dzDGTuc3qw/kEHWimY+bX2Xgh0="
  distributions: sdist bdist_wheel
  on:
    tags: true
    repo: jmuelbert/jmopenorders
